Write a C# Script for Space Engineers to control an autonomous survey drone. As a reminder, you should have a method public Program() that will be called by Space Engineers when your script is initialized and should set the RuntimeInfo.UpdateFrequency. You should then put your code in public void Main(string argument, UpdateType updateSource), creating extra methods to be called by Main as needed. Because of the limitations of Space Engineers you may not create a class called Program, or use any imports, usings or namespaces.

The script will run on a large-grid survey drone. The drone will have a laser antenna, a ore detector, a programmable block, a text panel, as well as cameras, sensors, and thrusters pointing in every direction. If any additional blocks are needed please make note of them after your script.

The script should begin by gathering the previously mentioned components and storing them in variables. The script should then attempt to load the drones origin point from the text panel, or write the origin point to the text panel if it has not yet been written.

The script must be an AI that executes a series of routines defined below. Because each routine will span multiple ticks the AI must be able to save its state at the end of each tick and recall it at the beginning of the next. Routines should be able to hand off to one another as necessary to allow the AI to accomplish complex tasks.

- General Routine (done every tick regardless of other routines running): Check if we can phone home using the laser antenna, if we can, save the current location as the last phone-home location, if we cannot, do nothing.

- Search Routine: The ship should proceed in a spiral path from the origin point, the spiral should be shaped so that each arm is 1km from the previous arm (this distance should be stored in a constant at the top of the file). Whenever an asteroid comes within 400m of the ship (also saved in a constant), the AI should enter the Survey Routine on the asteroid. If the asteroid has already been scouted (because the Survey Routine has returned execution to us or otherwise), ensure that we do not scout it again and we do not crash into it. Use GoTo to handle pathing and set waypoints 1km apart for pathing.

- Survey Routine (Asteroid Coords): The AI should save the location it begins the routine in. The ship should then proceed to the highlighted asteroid and do an orbit around the equater, and then another orbit 90 degrees to that orbit passing through the poles, of the asteroid. The orbits should bring the ore detector within 20 meters (saved in a constant) of the asteroids surface, without allowing the ship to crash into the asteroid. As the orbits are taking place, the coordinates and types of any ore veins seen should be saved. When the  orbits are finish, the PhoneHome Routine should be called with the ore veins types and coordinates, as well as the coordinate this routine was started from, passed as parameters. If multiple asteroids are within 400m when the Survey routine is started, survey all of them before executing PhoneHome. Once phone home returns execution to us, use GoTo to return to the starting point of this routine and return execution to Search.

- PhoneHome Routine(Message, ReturnRoutine): Transmit via inter-grid communication to the laser antenna on the other end of the laser antenna the Message. If we do not currently have connection, proceed to the saved phone-home coordinates using GoTo Routine and broadcast from there. If we do not have connection there, sit and wait. The channel used should be the ID of our laser antenna. Once we have connection, continue to broadcast the Message every tick until we receive a message of "Ack" on the same channel. After we have received the Ack, return to the ReturnRoutine.

- GoTo Routine(Coords, ReturnRoutine): Go to the specified coordinates, if there are any objects in the way path around them. After we reach the coordinates, return execution to the ReturnRoutine.

If you need more information to complete this script, please request it before writing the script.